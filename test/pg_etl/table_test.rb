# frozen_string_literal: true

require "test_helper"

module PgEtl
  class TableTest < Minitest::Test

    def pages_def
      [{:table_name=>"insight_core_pages",
        :column_name=>"account_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"active",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>"1",
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"ancestors",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"body",
        :data_type=>"text",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"code",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"created_at",
        :data_type=>"timestamp without time zone",
        :is_nullable=>"NO",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>"6",
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"description",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"group",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"id",
        :data_type=>"bigint",
        :is_nullable=>"NO",
        :column_default=>"nextval('insight_core_pages_id_seq'::regclass)",
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"64"},
       {:table_name=>"insight_core_pages",
        :column_name=>"keywords",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"page_type",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>"1",
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"parent_code",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"parent_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"partial",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"prefs",
        :data_type=>"jsonb",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"resource_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"resource_type",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"title",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"updated_at",
        :data_type=>"timestamp without time zone",
        :is_nullable=>"NO",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>"6",
        :numeric_precision=>nil}]
    end

    def pages_def2
      [{:table_name=>"insight_core_pages",
        :column_name=>"account_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"active",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>"1",
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"ancestors",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"body",
        :data_type=>"text",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"code",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"created_at",
        :data_type=>"timestamp without time zone",
        :is_nullable=>"NO",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>"6",
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"description",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"group",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"id",
        :data_type=>"bigint",
        :is_nullable=>"NO",
        :column_default=>"nextval('insight_core_pages_id_seq'::regclass)",
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"64"},
       {:table_name=>"insight_core_pages",
        :column_name=>"keywords",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"page_type",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>"1",
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"parent_code",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"parent_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"partial",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"prefs",
        :data_type=>"jsonb",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"resource_id",
        :data_type=>"integer",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>"32"},
       {:table_name=>"insight_core_pages",
        :column_name=>"resource_type",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"title",
        :data_type=>"character varying",
        :is_nullable=>"YES",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>nil,
        :numeric_precision=>nil},
       {:table_name=>"insight_core_pages",
        :column_name=>"updated_at",
        :data_type=>"timestamp without time zone",
        :is_nullable=>"NO",
        :column_default=>nil,
        :character_maximum_length=>nil,
        :datetime_precision=>"6",
        :numeric_precision=>nil}]
    end

    test "build pages" do
      t = Table.new(name: "insight_core_pages", col_array: pages_def)
      assert_equal "insight_core_pages", t.name
      assert_equal 19, t.num_columns
    end
  end
end
